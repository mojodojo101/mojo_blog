<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><head><script defer data-domain="c2.quest" src="https://plausible.io/js/plausible.js"></script><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Having A Look At Portable Executables" /><meta name="author" content="Mojo" /><meta property="og:locale" content="en_US" /><meta name="description" content="Just another Infosec blog :p" /><meta property="og:description" content="Just another Infosec blog :p" /><link rel="canonical" href="https://c2.quest/archived/2020-06-02-PortableExecutable.html" /><meta property="og:url" content="https://c2.quest/archived/2020-06-02-PortableExecutable.html" /><meta property="og:site_name" content="Mojodojo’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-02-06T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Having A Look At Portable Executables" /><meta name="twitter:site" content="@Mojodojo_101" /><meta name="twitter:creator" content="@Mojo" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Mojo"},"dateModified":"2020-02-06T00:00:00+01:00","datePublished":"2020-02-06T00:00:00+01:00","description":"Just another Infosec blog :p","headline":"Having A Look At Portable Executables","mainEntityOfPage":{"@type":"WebPage","@id":"https://c2.quest/archived/2020-06-02-PortableExecutable.html"},"url":"https://c2.quest/archived/2020-06-02-PortableExecutable.html"}</script><title>Having A Look At Portable Executables | Mojodojo's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.jpg"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.jpg"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.jpg"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mojodojo's Blog"><meta name="application-name" content="Mojodojo's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LTMTPRJBM7"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-LTMTPRJBM7'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/mojodojo101_avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mojodojo's Blog</a></div><div class="site-subtitle font-italic"><a href="https://discord.gg/infosecprep" target="_blank" rel="noopener noreferrer">discord.gg/infosecprep</a></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/mojodojo101" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/Mojodojo_101" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cnn.mr.hide','googlemail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/archived"> Archived </a> </span> <span>Having A Look At Portable Executables</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Having A Look At Portable Executables</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mojo </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Feb 6, 2020, 12:00 AM +0000" prep="on" > Feb 6, 2020 <i class="unloaded">2020-02-06T00:00:00+01:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="927 words">5 min</span></div></div><div class="post-content"><h1 id="examining-windows-exes-and-dlls"><strong>Examining Windows EXEs and DLLs</strong></h1><h4 id="tools">Tools:</h4><ul><li><a href="https://mh-nexus.de/en/hxd/">HxD</a><li><a href="https://visualstudio.microsoft.com/de/vs/?rr=https%3A%2F%2Fwww.google.com%2F">Visual Studio</a><li><a href="http://www.heaventools.com/">Pe Explorer</a><li><a href="https://www.immunityinc.com/products/debugger/">Immunity</a></ul><h4 id="this-is-the-source-code-i-used-to-create-an-example-executable">This is the source code i used to create an example executable.</h4><h4 id="i-used-visual-studio-2019s-default-compiler-and-c">I used Visual Studio 2019s default compiler and C++</h4><h4 id="when-you-dont-understand-something-try-to-cross-reference-it-with-this-link">When you don’t understand something try to cross reference it with this link:</h4><p><a href="https://docs.microsoft.com/en-us/windows/win32/debug/pe-format">Microsoft PE. docs.microsoft.com</a></p><h4 id="the-other-important-source-i-used-is-this-pdf">The other important Source i used is this PDF:</h4><p><a href="http://www.stonedcoder.org/~kd/lib/CBJ-2005-74.pdf">Goppit Portable Executable. stondecoder.ord</a></p><h4 id="there-are-small-differences-between-x86-and-x64-i-will-focus-on-x86">There are small differences between x86 and x64 i will focus on x86.</h4><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp">
</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">sayHello</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">"Hello %s"</span><span class="p">,</span><span class="n">name</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
	<span class="kt">char</span><span class="o">*</span> <span class="n">name</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">sayHello</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This code will simply take the first argument we pass to our Exe and print “Hello “+ your argument.</p><h3 id="portable-executable">Portable Executable</h3><h4 id="dos-header-64-bytes">DOS Header 64 bytes</h4><div class="table-wrapper"><table><thead><tr><th>Offset<th>Value<th>Meaning<tbody><tr><td>0x00<td>0x4D5A or MZ<td>E-magic: Stands for Mark Zbikowsky who created the PE format<tr><td>0x3c<td>0x0100<td>E-lfanew: The offset to the start of the Pe Header</table></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/pictures/portable-executable/pe-hex-dos-header.PNG" alt="Dos Header" /></p><h4 id="pe-header">PE Header</h4><div class="table-wrapper"><table><thead><tr><th>Offset<th>Value<th>Meaning<tbody><tr><td>0x0100<td>0x50450000<td>Signature: “PE” folloewd by 2x 0x00<tr><td>0x0104<td>20 bytes<td>Image File Header<tr><td>0x0118<td>224 bytes<td>Optional Header</table></div><h4 id="file-header">File Header</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/pictures/portable-executable/pe-file-header.PNG" alt="PE File Header" /></p><p>The location of the Header will depend on the E-lfanew value in the Dos Header</p><div class="table-wrapper"><table><thead><tr><th>Offset<th>Value<th>Meaning<tbody><tr><td>0x0104<td>0x4c01<td>Machine: For example i386<tr><td>0x0106<td>0x0500<td>Number of sections: .text.rdata.data.rsrc.reloc<tr><td>0x0108<td>0x20663C5E<td>Time of creation: 2020/02/06 19:16:48<tr><td>0x010c<td>0x00000000<td>Pointer to symbol table: 0 here because not debug Version<tr><td>0x0110<td>0x00000000<td>Number of symbols<tr><td>0x0114<td>0xE000<td>Size of Optional Header<tr><td>0x0116<td>0x0201<td>Characteristics: see below</table></div><p><a href="https://docs.microsoft.com/en-us/windows/win32/debug/pe-format#characteristics">Characteristics</a></p><details><summary>Characteristics 0x0201</summary> 1. MAGE_FILE_RELOCS_STRIPPED 0x0001. Image only, Windows CE, and Microsoft Windows NT and later. This indicates that the file does not contain base relocations and must therefore be loaded at its preferred base address. If the base address is not available, the reports an error. The default behavior of the linker is to strip base relocations from executable (EXE) files. 2. IMAGE_FILE_DEBUG_STRIPPED 0x0200.Debugging information is removed from the image file. </details><h4 id="optional-header-224-bytes">Optional Header 224 bytes</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/pictures/portable-executable/pe-optional-header.PNG" alt="Optional Header" /></p><p>The Last 128 bytes contain the Data Directory</p><p><a href="https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_optional_header32">Optional Header. docs.microsoft.com</a></p><div class="table-wrapper"><table><thead><tr><th>Offset<th>Value<th>Meaning<tbody><tr><td>0x0118<td>0x0b01<td>Magic Number: either 0x10b or 0x20b<tr><td>0x011a<td>0x0E18<td>Linker Version<tr><td>0x011c<td>0x000E0000<td>Size of Code Section<tr><td>0x0120<td>0x00140000<td>Size of Initialized Data<tr><td>0x0124<td>0x00000000<td>Size of Unitialized Data<tr><td>0x0128<td>0xB2120000<td>Address of Entrypoint <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup><tr><td>0x012c<td>0x00100000<td>Base of Code<tr><td>0x0130<td>0x00200000<td>Base of Data<tr><td>0x0134<td>0x00004000<td>Image Base <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup><tr><td>0x0138<td>0x00100000<td>Section Alignment <sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup><tr><td>0x013c<td>0x00020000<td>File Alignment<tr><td>0x0140+16 bytes<td>versions<td>A bunch of version Stuff<tr><td>0x0150<td>0x00600000<td>Size of Image<tr><td>0x0154<td>0x00400000<td>Size of Headers<tr><td>0x0158<td>0x00000000<td>CheckSum<tr><td>0x015c<td>0x0300<td>Subsystem<tr><td>0x015e<td>0x4081<td>DllCharacteristics !!Important<tr><td>0x0160<td>0x00001000<td>Size of Stack Reserve<tr><td>0x0164<td>0x00100000<td>Size of Stack Commit<tr><td>0x0168<td>0x00001000<td>Size of Heap Reserve<tr><td>0x016c<td>0x00100000<td>Size of Heap Commit<tr><td>0x0170<td>0x00000000<td>Loader Flags <sup id="fnref:6" role="doc-noteref"><a href="#fn:6" class="footnote" rel="footnote">4</a></sup><tr><td>0x0174<td>0x10000000<td>Number of directory entries <sup id="fnref:7" role="doc-noteref"><a href="#fn:7" class="footnote" rel="footnote">5</a></sup><tr><td>0x0178<td>0x00000000<td>Virtual address of Data Dir<tr><td>0x017c<td>0x00000000<td>Size of Data directory</table></div><p>An example how this looks mapped to memory in the debugger. <a href="https://www.immunityinc.com/products/debugger/">Immunity</a> :</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/pictures/portable-executable/pe-debugger-peheader.PNG" alt="Pe Header. Immunity" /></p><h4 id="data-directory">Data Directory</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/pictures/portable-executable/pe-data-directory-entrys.PNG" alt="Pe Data Directory" /></p><p>In our case we have 16 Data Directory Entrys</p><div class="table-wrapper"><table><thead><tr><th>Offset<th>Value<th>Meaning<tbody><tr><td>0x0178<td>0x00000000<td>Export Table Address=0 <sup id="fnref:10" role="doc-noteref"><a href="#fn:10" class="footnote" rel="footnote">6</a></sup><tr><td>0x017c<td>0x00000000<td>Export Table Size=0<tr><td>0x0180<td>0x4c250000<td>Import Table Address <sup id="fnref:11" role="doc-noteref"><a href="#fn:11" class="footnote" rel="footnote">7</a></sup><tr><td>0x0184<td>0xA0000000<td>Import Table Size=10<tr><td>0x0188<td>0x00400000<td>Resource Table Address<tr><td>0x018c<td>0xE0010000<td>Resource Table Size<tr><td>0x0190<td>0x00000000<td>Exeption Table Address<tr><td>0x0194<td>0x00000000<td>Exception Table Size<tr><td>0x0198<td>0x00000000<td>Certificate Table Address<tr><td>0x019c<td>0x00000000<td>Certificate Table Size<tr><td>0x01a0<td>0x00500000<td>Relocation Table Address<tr><td>0x01a4<td>0x54010000<td>Relocation Table Size<tr><td>0x01a8<td>0x20210000<td>Debug Data Address<tr><td>0x01ac<td>0x70000000<td>Debug Data Size<tr><td>0x01b0<td>0x00000000<td>Architecture Data Address<tr><td>0x01b4<td>0x00000000<td>Architecture Data Size<tr><td>0x01b8<td>0x00000000<td>Global Pointer Address<tr><td>0x01bc<td>0x00000000<td>Must be 0<tr><td>0x01c0<td>0x00000000<td>Thread Local Storage Address<tr><td>0x01c4<td>0x00000000<td>Thread Local Storage Size<tr><td>0x01c8<td>0x90210000<td>Load Config Table Address<tr><td>0x01cc<td>0x40000000<td>Load Config Table Size<tr><td>0x01d0<td>0x00000000<td>Bound Import Table Address<tr><td>0x01d4<td>0x00000000<td>Bound Import Table Size<tr><td>0x01d8<td>0x00200000<td>Import Address Table Adress<tr><td>0x01dc<td>0xC4000000<td>Import Address Table Size<tr><td>0x01e0<td>0x00000000<td>Delay-Load Import Table Addr<tr><td>0x01e4<td>0x00000000<td>Delay-Load Import Table Size<tr><td>0x01e8<td>0x00000000<td>CLR Header Address<tr><td>0x01f0<td>0x00000000<td>CLR Header Size<tr><td>0x01f4<td>0x00000000<td>Reserved<tr><td>0x01f8<td>0x00000000<td>Reserved</table></div><h4 id="section-headers">Section Headers</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/pictures/portable-executable/pe-header-section-text.PNG" alt="Pe Section Header" /></p><h5 id="i-will-only-list-the-text-section-for-this-one">I will only list the .text section for this one.</h5><h5 id="the-name-of-a-section-are-kept-in-the-first-8-bytes-of-the-header">The name of a Section are kept in the first 8 bytes of the Header</h5><div class="table-wrapper"><table><thead><tr><th>Offset<th>Value<th>Meaning<tbody><tr><td>0x01F8<td>0x2E74657874000000<td>Name of Section (here .text)<tr><td>0x0200<td>0xFC0C0000<td>Virtual Size<tr><td>0x0208<td>0x00100000<td>Virtual Address<tr><td>0x020C<td>0x000E0000<td>Size of Raw Data<tr><td>0x0210<td>0x00040000<td>Pointer to raw Data<tr><td>0x0214<td>0x00000000<td>Pointer to Relocations<tr><td>0x0218<td>0x00000000<td>Pointer to Linenumbers<tr><td>0x0219<td>0x0000<td>Number of Relocations<tr><td>0x021B<td>0x0000<td>Number of Linenumbers<tr><td>0x021D<td>0x20000006<td>Characteristics /permissions</table></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/pictures/portable-executable/pe-debugger-sections.PNG" alt="Pe Sections. Immunity" /></p><p><a href="http://www.sandsprite.com/CodeStuff/Understanding_imports.html">Understanding imports. sandsprite.com</a></p><h4 id="footnotes">Footnotes:</h4><div class="footnotes" role="doc-endnotes"><ol><li id="fn:1" role="doc-endnote"><p>When you attach a debugger the Entry Point will be the location in Virtual Address Space where EIP will first be located. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:2" role="doc-endnote"><p>The Image Base is the point in the Virtual Address Space where you will find the first byte of your Image. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:3" role="doc-endnote"><p>The Section alignment has to be greater than or equal to the File alignment. This variable determines how memory is mapped from your disk to random access memory. <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:6" role="doc-endnote"><p>Certain debuggers cant handle corrupted flags + number of RVA and sizes and will run the exe without debugging. Pretty interesting for malware. <a href="#fnref:6" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:7" role="doc-endnote"><p>Each one of the Data Directories has 2 fields. The first one is a pointer to the Directory and the second one determines the Size. In our example there are 16 Data Directories. These Directories contain stuff like import and export table, so they are definitely important for reverse engineering. <a href="#fnref:7" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:10" role="doc-endnote"><p>When a table has no entries the data directory will contain 0x00000000 <a href="#fnref:10" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:11" role="doc-endnote"><p>Might want to read up on the <a href="https://docs.microsoft.com/en-us/windows/win32/debug/pe-format#import-directory-table">Import directory table</a> <a href="#fnref:11" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/portable-executables/'>Portable Executables</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Having A Look At Portable Executables - Mojodojo's Blog&url=https://c2.quest/archived/2020-06-02-PortableExecutable.html" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Having A Look At Portable Executables - Mojodojo's Blog&u=https://c2.quest/archived/2020-06-02-PortableExecutable.html" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Having A Look At Portable Executables - Mojodojo's Blog&url=https://c2.quest/archived/2020-06-02-PortableExecutable.html" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/@Mojodojo_101">Mojodojo101</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://c2.quest{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
